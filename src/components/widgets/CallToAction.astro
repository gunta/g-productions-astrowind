---
import WidgetWrapper from '../ui/WidgetWrapper.astro';
import type { CallToAction as CTAType, Widget } from '~/types';
import Button from '~/components/ui/Button.astro';

interface Props extends Widget {
  title?: string;
  subtitle?: string;
  tagline?: string;
  callToAction?: CTAType;
  actions?: string | CTAType[];
}

const {
  title = await Astro.slots.render('title'),
  subtitle = await Astro.slots.render('subtitle'),
  tagline = await Astro.slots.render('tagline'),
  actions = await Astro.slots.render('actions'),

  id,
  isDark = false,
  classes = {},
  bg = await Astro.slots.render('bg'),
} = Astro.props;
---

<WidgetWrapper id={id} isDark={isDark} containerClass={`max-w-6xl mx-auto ${classes?.container ?? ''}`} bg={bg}>
  <div class="relative overflow-hidden">
    {/* Background gradient shapes */}
    <div class="absolute inset-0 pointer-events-none" aria-hidden="true">
      <div class="absolute -top-20 -left-20 w-64 h-64 rounded-full bg-accent/10 blur-3xl"></div>
      <div class="absolute -bottom-20 -right-20 w-64 h-64 rounded-full bg-geometric-orange/10 blur-3xl"></div>
    </div>
    
    {/* Main CTA card */}
    <div
      class="relative max-w-4xl mx-auto text-center px-8 py-12 md:py-16 rounded-3xl 
             bg-white dark:bg-zinc-900 
             border border-zinc-200/60 dark:border-zinc-800/60
             shadow-elegant-lg"
    >
      {/* Decorative corner accents */}
      <div class="absolute top-4 left-4 w-8 h-8 border-t-2 border-l-2 border-accent/30 rounded-tl-xl"></div>
      <div class="absolute bottom-4 right-4 w-8 h-8 border-b-2 border-r-2 border-geometric-orange/30 rounded-br-xl"></div>
      
      {/* Tagline */}
      {tagline && (
        <div class="inline-flex items-center gap-2 mb-4">
          <span class="w-6 h-px bg-accent"></span>
          <span class="text-sm font-semibold tracking-wide uppercase text-accent" set:html={tagline} />
          <span class="w-6 h-px bg-accent"></span>
        </div>
      )}
      
      {/* Title */}
      {title && (
        <h2 
          class="font-display font-semibold text-3xl md:text-4xl tracking-tight text-ink dark:text-white mb-4"
          set:html={title}
        />
      )}
      
      {/* Subtitle */}
      {subtitle && (
        <p 
          class="text-lg text-ink-secondary dark:text-zinc-400 max-w-2xl mx-auto mb-8"
          set:html={subtitle}
        />
      )}
      
      {/* Content slot */}
      <slot name="content" />
      
      {/* Actions */}
      {actions && (
        <div class="flex flex-wrap justify-center gap-4 mt-8">
          {Array.isArray(actions) ? (
            actions.map((action, index) => (
              <Button 
                {...(action || {})} 
                class:list={[
                  'px-8 py-4',
                  index === 0 ? 'btn-primary' : 'btn-secondary'
                ]}
              />
            ))
          ) : (
            <Fragment set:html={actions} />
          )}
        </div>
      )}
    </div>
  </div>
</WidgetWrapper>
