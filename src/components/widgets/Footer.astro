---
import { Icon } from 'astro-icon/components';
import { SITE } from 'astrowind:config';
import { getHomePermalink } from '~/utils/permalinks';

interface Link {
  text?: string;
  href?: string;
  ariaLabel?: string;
  icon?: string;
}

interface Links {
  title?: string;
  links: Array<Link>;
}

export interface Props {
  links: Array<Links>;
  secondaryLinks: Array<Link>;
  socialLinks: Array<Link>;
  footNote?: string;
  theme?: string;
}

let { socialLinks = [], secondaryLinks = [], links = [], footNote = '', theme = 'light' } = Astro.props;

// Reset - but keep the data for the new footer
secondaryLinks = [];
links = [];
socialLinks = [];
---

<footer class:list={[{ dark: theme === 'dark' }, 'relative not-prose bg-surface-alt dark:bg-zinc-900']}>
  {/* Top decorative line */}
  <div class="h-px bg-gradient-to-r from-transparent via-zinc-300 dark:via-zinc-700 to-transparent"></div>
  
  <div class="relative max-w-7xl mx-auto px-6 lg:px-8">
    {/* Main footer content */}
    <div class="py-12 md:py-16">
      <div class="grid grid-cols-12 gap-8 lg:gap-12">
        {/* Brand column */}
        <div class="col-span-12 lg:col-span-4">
          <a 
            class="inline-flex items-center gap-2 group" 
            href={getHomePermalink()}
          >
            <span class="font-display font-semibold text-xl text-ink dark:text-white group-hover:text-accent transition-colors">
              {SITE?.name}
            </span>
          </a>
          
          <p class="mt-4 text-sm text-ink-secondary dark:text-zinc-400 max-w-xs leading-relaxed">
            Crafting AI-powered futures through innovation, technology, and cross-cultural expertise.
          </p>
          
          {/* Social links */}
          {socialLinks?.length > 0 && (
            <div class="mt-6 flex gap-3">
              {socialLinks.map(({ ariaLabel, href, icon }) => (
                <a
                  class="w-10 h-10 flex items-center justify-center rounded-xl
                         bg-white dark:bg-zinc-800 
                         border border-zinc-200 dark:border-zinc-700
                         text-ink-secondary dark:text-zinc-400
                         hover:text-accent hover:border-accent dark:hover:text-accent dark:hover:border-accent
                         transition-all duration-200"
                  aria-label={ariaLabel}
                  href={href}
                  target="_blank"
                  rel="noopener noreferrer"
                >
                  {icon && <Icon name={icon} class="w-5 h-5" />}
                </a>
              ))}
            </div>
          )}
        </div>
        
        {/* Link columns */}
        {links.map(({ title, links: linkItems }) => (
          <div class="col-span-6 md:col-span-3 lg:col-span-2">
            <h3 class="font-heading font-semibold text-sm text-ink dark:text-white mb-4">
              {title}
            </h3>
            {linkItems && Array.isArray(linkItems) && linkItems.length > 0 && (
              <ul class="space-y-3">
                {linkItems.map(({ text, href, ariaLabel }) => (
                  <li>
                    <a
                      class="text-sm text-ink-secondary dark:text-zinc-400 
                             hover:text-accent dark:hover:text-accent 
                             transition-colors duration-200"
                      href={href}
                      aria-label={ariaLabel}
                    >
                      <Fragment set:html={text} />
                    </a>
                  </li>
                ))}
              </ul>
            )}
          </div>
        ))}
      </div>
    </div>
    
    {/* Bottom bar */}
    <div class="border-t border-zinc-200 dark:border-zinc-800 py-6">
      <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
        {/* Secondary links */}
        {secondaryLinks?.length > 0 && (
          <div class="flex flex-wrap gap-4 text-sm">
            {secondaryLinks.map(({ text, href }) => (
              <a
                class="text-ink-tertiary hover:text-ink dark:text-zinc-500 dark:hover:text-zinc-300 transition-colors"
                href={href}
                set:html={text}
              />
            ))}
          </div>
        )}
        
        {/* Copyright */}
        <div class="text-sm text-ink-tertiary dark:text-zinc-500">
          {footNote ? (
            <Fragment set:html={footNote} />
          ) : (
            <span>Â© {new Date().getFullYear()} {SITE?.name}. All rights reserved.</span>
          )}
        </div>
      </div>
    </div>
  </div>
</footer>
